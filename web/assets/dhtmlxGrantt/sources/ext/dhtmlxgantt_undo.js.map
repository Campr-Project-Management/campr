{"version":3,"file":"dhtmlxgantt_undo.js","sources":["dhtmlxgantt_undo.js"],"names":["gantt","config","undo_steps","undo","redo","this","_undo","getUndoStack","_undoStack","getRedoStack","_redoStack","undo_types","link","task","undo_actions","update","remove","add","maxSteps","undo_enabled","redo_enabled","_push","stack","action","commands","length","push","shift","_pop","pop","updateConfigs","callEvent","_applyAction","invert","command","entities","entity","actions","type","methods","isExists","batchUpdate","i","method","check","oldValue","parent","$index","value","id","logAction","create","slice","revert","copy","inverseCommands","load","clear","assert","monitor","_batchAction","_batchMode","_ignore","startIgnore","stopIgnore","startBatchAction","timeout","clearTimeout","setTimeout","stopBatchAction","_storeCommand","_storeEntityCommand","obj","old","actionType","entityType","_storeTaskCommand","getInitialTask","_storeLinkCommand","getInitialLink","onTaskAdded","onTaskUpdated","onTaskDeleted","_nestedTasks","children","_nestedLinks","childrenLinks","onLinkAdded","onLinkUpdated","onLinkDeleted","_initialTasks","_getLinks","$source","concat","$target","setNestedTasks","taskIds","tasks","linkIds","getTask","setInitialTask","uniqueLinks","links","setInitialLink","getTaskIndex","_initialLinks","getLink","store","updTask","oldId","newId","changeTaskCommandId","updLink","oldTaskId","newTaskId","source","target","changeLinkCommandId","updateTasksIds","log","entry","j","updateLinksIds","noTrack","onBeforeUndo","onBeforeRedo","attachEvent","batchActions","nested","eachTask"],"mappings":"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"}