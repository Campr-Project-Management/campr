##############
# pmtool.com #
##############

Include /var/www/pmtool.com/current/app/config/apache/common_header.conf

<IfModule mod_setenvif.c>
    SetEnvIfNoCase Host ^topobot\.ro SYMFONY_ENV=prod
    SetEnvIfNoCase Host ^topobot\.ro SYMFONY_DEBUG=false
    SetEnvIfNoCase Host www\.topobot\.ro SYMFONY_ENV=prod
    SetEnvIfNoCase Host www\.topobot\.ro SYMFONY_DEBUG=false
</IfModule>

<VirtualHost *:80>
    ServerName pmtool.com
    ServerAlias www.pmtool.com
    ServerAdmin info@pmtool.com

    LogLevel warn
    ErrorLog /var/www/pmtool.com/current/var/logs/error.log
    CustomLog /var/www/pmtool.com/current/var/logs/access.log combined

    <IfModule mod_rewrite.c>
        RewriteEngine On

        # add www and redirect to https
        #RewriteCond %{HTTP_HOST} !^www\.
        #RewriteRule ^(.*)$ https://www.%{HTTP_HOST}/$1 [R=301,L]

        #redirect to https
        RewriteCond %{HTTP_HOST} !^$
        RewriteRule ^ https://%{SERVER_NAME}%{REQUEST_URI} [R=301,L]
    </IfModule>
</VirtualHost>

<IfModule mod_ssl.c>

    SSLStrictSNIVHostCheck off

    <VirtualHost *:443>
        ServerName pmtool.com

        Include /var/www/pmtool.com/current/app/config/apache/common_prod.conf

        SSLCertificateFile /var/www/app/config/ssl/pmtool.com/cert.pem
        SSLCertificateKeyFile /var/www/app/config/ssl/pmtool.com/privkey.pem
        SSLCACertificateFile /var/www/app/config/ssl/pmtool.com/fullchain.pem
    </VirtualHost>

    <VirtualHost *:443>
        ServerName www.pmtool.com

        Include /var/www/pmtool.com/current/app/config/apache/common_prod.conf

        SSLCertificateFile /var/www/pmtool.com/current/app/config/ssl/www.pmtool.com/cert.pem
        SSLCertificateKeyFile /var/www/pmtool.com/current/app/config/ssl/www.pmtool.com/privkey.pem
        SSLCACertificateFile /var/www/pmtool.com/current/app/config/ssl/www.pmtool.com/fullchain.pem
    </VirtualHost>
</IfModule>
